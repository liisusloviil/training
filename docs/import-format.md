# Формат импорта плана

Дата обновления: 23 февраля 2026

## Поддерживаемые файлы

- `.xlsx`
- `.csv` (разделитель `;`, допускается UTF-8 BOM)

Ограничения файла:

- размер до `5 MB`;
- до `8` листов для `.xlsx`;
- до `3000` строк на лист/CSV.

## Обязательные колонки

Парсер ищет строку заголовков и определяет минимум две колонки:

- `упражнение` / `упражнения` / `exercise`
- `подходы×повторы` / `подходы х повторения` / `sets×reps`

Опционально:

- `неделя` / `week`
- `день` / `day`
- `интенсивность` / `intensity`

## Маркеры недели и дня

Допускаются два стиля:

1. Явные колонки `неделя` и `день`.
2. Маркерные строки в первой колонке (например для `Training.csv`):
- `неделя 1`
- `понедельник`, `среда`, `пятница`

Упражнения ниже маркеров автоматически привязываются к текущей неделе и дню.

## Формат `подходы×повторы`

Поддерживаются:

- фикс: `N×M` (пример: `4×10`)
- диапазон: `N×A-B` (пример: `4×8-12`)

Нормализация:

- `x`, `х`, `*` приводятся к `×`;
- пробелы удаляются;
- в БД и UI сохраняется нормализованный `rawSetsReps`.

Валидация:

- `N > 0`
- `M > 0`
- `A > 0`, `B > 0`, `A <= B`

## Пример CSV (фрагмент)

```csv
упражнения;интенсивность;подходы х повторения
неделя 1;;
понедельник;;
жим лежа 0°;средняя;4х8-12
тяга вертикального блока;средняя;4х8-12
```

## Ошибки валидации

Примеры сообщений:

- `Поддерживаются только форматы .xlsx и .csv.`
- `Некорректный формат "подходы×повторы" ...`
- `Некорректный диапазон повторов ... Левая граница должна быть <= правой.`
- `упражнение указано раньше, чем неделя/день недели`.
